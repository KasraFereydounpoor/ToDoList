{% load static %}

<div class="card shadow-sm p-5 rounded bg-white mt-4" style="max-width:400px;width:100%;">
    <h4 class="text-center" style="color:#23478e;">پیشرفت امروز</h4>
    {% if today_total > 0 %}
        <div class="my-3 text-center" style="font-size:18px;color:#14a44d;">
            {{ today_completed }} از {{ today_total }} کار امروز انجام شد!
        </div>
        <canvas id="todopie" style="max-width:220px; margin:auto;"></canvas>
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <script>
            const ctx = document.getElementById('todopie').getContext('2d');
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['انجام شده', 'انجام نشده'],
                    datasets: [{
                        data: [{{ today_completed }}, {{ today_uncompleted }}],
                        backgroundColor: ['#28a745','#dc3545'],
                        borderWidth: 3,
                    }]
                },
                options: {
                    plugins: {
                        legend: { display: true, position: 'bottom' }
                    }
                }
            });
        </script>
        <div class="text-center mt-3">
            <span class="text-success mx-2">انجام شده: {{ today_completed }}</span>
            <span class="text-danger mx-2">انجام نشده: {{ today_uncompleted }}</span>
            <span class="mx-2 text-secondary">کل: {{ today_total }}</span>
        </div>
        <div class="mt-2 text-center text-primary fw-bold">درصد انجام: {{ percent_today }}%</div>
    {% else %}
        <div class="text-center text-muted py-4">امروز هیچ کاری ثبت نشده</div>
    {% endif %}
</div>
<script src="{% static 'js/darkmode.js' %}"></script>